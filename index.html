<!DOCTYPE html>
<html>
<head>
  <title>R Tutorial</title>
  <meta charset="utf-8">
  <meta name="description" content="R Tutorial">
  <meta name="author" content="Sebastian Campbell and José Padarian">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/tomorrow.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
    <link rel="stylesheet" href = "libraries/widgets/quiz/css/jquery-quiz.css">
<link rel="stylesheet" href = "libraries/widgets/bootstrap/css/bootstrap.css">
<link rel="stylesheet" href = "libraries/widgets/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href = "assets/css/ribbons.css">

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
    <!-- END LOGO SLIDE -->
    

    <!-- TITLE SLIDE -->
    <!-- Should I move this to a Local Layout File? -->
    <slide class="title-slide segue nobackground">
      <aside class="gdbar">
        <img src="assets/img/university_sydney_logo.png">
      </aside>
      <hgroup class="auto-fadein">
        <h1>R Tutorial</h1>
        <h2>April 2013</h2>
        <p>Sebastian Campbell and José Padarian<br/>Use the left and right arrow keys to navigate slides.</p>
      </hgroup>
      
      <footer class = 'license'>
        <a href='http://creativecommons.org/licenses/by-nc-nd/3.0/'>
        <img width = '80px' src = 'http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-nd.png'>
        </a>
      </footer>
    </slide>

    <!-- SLIDES -->
      <slide class="" id="slide-1" style="background:;">
  <hgroup>
    <h2>What is R?</h2>
  </hgroup>
  <article>
    <p>R is an open-source statistical programming language. It is now widely used in both business and academia. It is both powerful and actively developed, so the number of add-on packages for it are constantly increasing.</p>

<p><img src="images/R logo.jpg" style="margin:0px auto;display:block"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-2" style="background:;">
  <hgroup>
    <h2>Why use R for spectroscopy?</h2>
  </hgroup>
  <article>
    <ul>
<li>R is free

<ul>
<li>Other spectroscopy software (e.g. Unscrambler) can cost in the vicinity of $6000</li>
<li>Other statistical software (SAS, SPSS) can cost around $3500/year</li>
<li>These costs make it harder to share your analysis with others</li>
</ul></li>
<li>R is the gift that keeps on giving

<ul>
<li>Not just for spectroscopy: mapping, modelling, 
data manipulation, web applications...</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Welcome to R</h2>
  </hgroup>
  <article>
    <p>Hopefully by now you&#39;ve started up RStudio (or your IDE or text editor of choice) and are greeted by a command prompt:</p>

<p><img src="images/rconsole.png" alt=""></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>Say Hello!</h2>
  </hgroup>
  <article>
    <p>As is traditional in programming, we&#39;ll start off with a <code>Hello world!</code> program. Try the below:</p>

<pre><code class="r">print(&quot;Hello world!&quot;)
</code></pre>

<pre><code>## [1] &quot;Hello world!&quot;
</code></pre>

<p>Congratulations! You&#39;ve taken your first steps into R. You&#39;ve used the function <code>print</code> to print the text &quot;Hello world!&quot; to the screen. Functions are basically like verbs in language, they tell R to do something. Notice the brackets <code>()</code> after the name of the function in which you can tell the function what to do.</p>

<p>Don&#39;t worry too much about the <code>[1]</code> at the beginning, we&#39;ll explain that soon. Note that you can also type <code>&quot;Hello world!&quot;</code> without the <code>print</code> command and R will assume you meant to print it.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-5" style="background:;">
  <hgroup>
    <h2>Some basic maths</h2>
  </hgroup>
  <article>
    <p>We can also use R as a calculator for addition and powers:</p>

<pre><code class="r">2 + 2
</code></pre>

<pre><code>## [1] 4
</code></pre>

<pre><code class="r">2^3
</code></pre>

<pre><code>## [1] 8
</code></pre>

<p>Note that there are other operators we can use, like <code>*</code> for multiplications, <code>-</code> for subtraction and <code>/</code> for division. </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="quiz" id="slide-6" style="background:;">
  <hgroup>
    <h2>Quick quiz</h2>
  </hgroup>
  <article>
    
<div class="quiz-single well new">
  <p>We&#39;ll be having a few quizzes like this during this tutorial. No pressure, it&#39;s just to check your understanding. Click &#39;Submit&#39; to check if your answer is right. If you give up &#39;Check answer&#39; will give you an answer. &#39;Clear&#39; will allow you to start that quiz from scratch.</p>

<h3>What is the expected result from <code>6 / 2</code>?</h3>

<ol>
<li>1</li>
<li>2</li>
<li><em>3</em></li>
<li>4</li>
</ol>


  
  <button class="quiz-submit btn btn-primary">Submit</button>
  
  <button class="quiz-show-answer btn btn-success">Show Answer</button>
  <button class="quiz-clear">Clear</button>
  
  
  <div class="quiz-hint">
    
  </div>
  
  <div class="quiz-explanation">
    <p>It&#39;s 3, because $\frac{6}{2} = 3$.</p>

  </div>
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-7" style="background:;">
  <hgroup>
    <h2>Assigning variables</h2>
  </hgroup>
  <article>
    <p>So now we can do some maths, but we don&#39;t want to have to remember the results every time. So let&#39;s store some as variable, so we can refer to them by name. To assign, we can use either the <code>=</code> or <code>&lt;-</code> operator (though <code>&lt;-</code> is recommended).</p>

<pre><code class="r">core_volume &lt;- 100
core_mass &lt;- 180
bulk_density &lt;- core_mass/core_volume

bulk_density
</code></pre>

<pre><code>## [1] 1.8
</code></pre>

<p>Note that assignment doesn&#39;t print the variable to the console.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-8" style="background:;">
  <hgroup>
    <h2>Not just numbers</h2>
  </hgroup>
  <article>
    <p>R doesn&#39;t just work with numbers, it can also work with &quot;strings&quot; or characters. Strings are denoted by the quotes (<code>&quot;&quot;</code>) surrounding them. We&#39;ve already used these when we made our &quot;Hello world!&quot; program. In fact, we can use the <code>paste</code> function to stick them together. </p>

<pre><code class="r">paste(&quot;The bulk density is:&quot;, 1.75, sep = &quot; &quot;)
</code></pre>

<pre><code>## [1] &quot;The bulk density is: 1.75&quot;
</code></pre>

<p>The <code>paste</code> function sticks strings and numbers together into a single string. The <code>sep</code> argument says: &quot;Put a space between all of the things I&#39;m sticking together&quot;.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>Making readable results</h2>
  </hgroup>
  <article>
    <p>Let&#39;s combine all the things we know so far into something useful. Remember the bulk density we calculated earlier?</p>

<pre><code class="r">paste(&quot;The bulk density is:&quot;, bulk_density, sep = &quot; &quot;)
</code></pre>

<pre><code>## [1] &quot;The bulk density is: 1.8&quot;
</code></pre>

<p>Here R evaluated our variable <code>bulk_density</code> and added it to the string we were trying to make.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="quiz" id="slide-10" style="background:;">
  <hgroup>
    <h2>Quiz 2</h2>
  </hgroup>
  <article>
    
<div class="quiz-single well new">
  <h3>Which of these lines of code will produce the result: <code>&quot;1:2:3:x:y:z&quot;</code></h3>

<ol>
<li><em>paste(1, 2, 3, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;, sep=&quot;:&quot;)</em></li>
<li>paste(&quot;123xyz&quot;, sep=&quot;:&quot;)</li>
<li>paste(1, 2, 3, x, y, z, sep=&quot;:&quot;)</li>
<li>paste(1, 2, 3, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;)</li>
</ol>


  
  <button class="quiz-submit btn btn-primary">Submit</button>
  
  <button class="quiz-show-answer btn btn-success">Show Answer</button>
  <button class="quiz-clear">Clear</button>
  
  
  <div class="quiz-hint">
    
  </div>
  
  <div class="quiz-explanation">
    <p>The first option. The second option won&#39;t work as there&#39;s only one string, so R can&#39;t place separators between strings. The third option is trying to call variables named <code>x</code>, <code>y</code> and <code>z</code> (but it&#39;s likely none exist). Finally, the fourth option is space-separated, not colon-separated.</p>

  </div>
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-11" style="background:;">
  <hgroup>
    <h2>Bigger data</h2>
  </hgroup>
  <article>
    <p>So we&#39;ve been dealing with individual strings and numbers, let&#39;s move onto combining those into vectors. A vector is basically just a 1-dimensional array of data. Like a set of numbers or a shopping list. It&#39;s really easy to make vectors of sequential integers:</p>

<pre><code class="r">1:10
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10
</code></pre>

<pre><code class="r">5:-5
</code></pre>

<pre><code>##  [1]  5  4  3  2  1  0 -1 -2 -3 -4 -5
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>More vectors</h2>
  </hgroup>
  <article>
    <p>You can also make vectors of strings or numbers using the combine (<code>c</code>) function:</p>

<pre><code class="r">c(5, 4, 3, 2, 8)
</code></pre>

<pre><code>## [1] 5 4 3 2 8
</code></pre>

<pre><code class="r">c(&quot;sand&quot;, &quot;silt&quot;, &quot;clay&quot;)
</code></pre>

<pre><code>## [1] &quot;sand&quot; &quot;silt&quot; &quot;clay&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h2>Limits of atomic vectors</h2>
  </hgroup>
  <article>
    <p>But be careful. These kinds of vectors can only take one type of data. If you combine numbers and strings together:</p>

<pre><code class="r">c(&quot;SOILID001&quot;, 3, 5, &quot;SOILID006&quot;, 7)
</code></pre>

<pre><code>## [1] &quot;SOILID001&quot; &quot;3&quot;         &quot;5&quot;         &quot;SOILID006&quot; &quot;7&quot;
</code></pre>

<p>Then they all become characters.</p>

<p>If you think about it, you can treat numbers as letters, but it&#39;s a lot harder to treat letters as numbers.</p>


  </article>
  <!-- Presenter Notes -->
  <aside class="note">
    <section>
      <p>Try to use the function <code>list()</code>. With this function you can combine any type of R objects.</p>

<pre><code class="r">list(&quot;a&quot;, c(1, 2, 3), matrix(1:4, 2, 2), list(2, &quot;b&quot;))
</code></pre>

<pre><code>## [[1]]
## [1] &quot;a&quot;
## 
## [[2]]
## [1] 1 2 3
## 
## [[3]]
##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4
## 
## [[4]]
## [[4]][[1]]
## [1] 2
## 
## [[4]][[2]]
## [1] &quot;b&quot;
</code></pre>

    </section>
  </aside>
</slide>

      <slide class="" id="slide-14" style="background:;">
  <hgroup>
    <h2>Even bigger data</h2>
  </hgroup>
  <article>
    <p>Now that we can make vectors we can make subsets of bigger datasets, matrices and dataframes. Just to start off, we&#39;ll use a simple dataset which comes with R: <code>trees</code> (Try <code>?trees</code> for more information about the data). It is a data frame, a collection of vectors as columns. The vectors are allowed to be different types (character, integer, numeric), but they must all be the same length.</p>

<pre><code class="r">trees
</code></pre>

<pre><code>##    Girth Height Volume
## 1    8.3     70   10.3
## 2    8.6     65   10.3
## 3    8.8     63   10.2
## 4   10.5     72   16.4
## 5   10.7     81   18.8
## 6   10.8     83   19.7
## 7   11.0     66   15.6
## 8   11.0     75   18.2
## 9   11.1     80   22.6
## 10  11.2     75   19.9
## 11  11.3     79   24.2
## 12  11.4     76   21.0
## 13  11.4     76   21.4
## 14  11.7     69   21.3
## 15  12.0     75   19.1
## 16  12.9     74   22.2
## 17  12.9     85   33.8
## 18  13.3     86   27.4
## 19  13.7     71   25.7
## 20  13.8     64   24.9
## 21  14.0     78   34.5
## 22  14.2     80   31.7
## 23  14.5     74   36.3
## 24  16.0     72   38.3
## 25  16.3     77   42.6
## 26  17.3     81   55.4
## 27  17.5     82   55.7
## 28  17.9     80   58.3
## 29  18.0     80   51.5
## 30  18.0     80   51.0
## 31  20.6     87   77.0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-15" style="background:;">
  <hgroup>
    <h2>Structure of objects</h2>
  </hgroup>
  <article>
    <p>Another way of examining objects is the <code>str()</code> function</p>

<pre><code class="r">str(trees)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    31 obs. of  3 variables:
##  $ Girth : num  8.3 8.6 8.8 10.5 10.7 10.8 11 11 11.1 11.2 ...
##  $ Height: num  70 65 63 72 81 83 66 75 80 75 ...
##  $ Volume: num  10.3 10.3 10.2 16.4 18.8 19.7 15.6 18.2 22.6 19.9 ...
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Summaries</h2>
  </hgroup>
  <article>
    <p>More useful information about the dataframe&#39;s columns can be obtained using <code>summary()</code>:</p>

<pre><code class="r">summary(trees)
</code></pre>

<pre><code>##      Girth          Height       Volume    
##  Min.   : 8.3   Min.   :63   Min.   :10.2  
##  1st Qu.:11.1   1st Qu.:72   1st Qu.:19.4  
##  Median :12.9   Median :76   Median :24.2  
##  Mean   :13.2   Mean   :76   Mean   :30.2  
##  3rd Qu.:15.2   3rd Qu.:80   3rd Qu.:37.3  
##  Max.   :20.6   Max.   :87   Max.   :77.0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2>Subsetting</h2>
  </hgroup>
  <article>
    <p>The basic form of a subset is <code>object[whichrows, whichcolumns]</code>. Leaving an element blank means select all. So for example, to get the third row of <code>trees</code>, or the second column:</p>

<pre><code class="r">trees[3, ]
</code></pre>

<pre><code>##   Girth Height Volume
## 3   8.8     63   10.2
</code></pre>

<pre><code class="r">trees[, 2]
</code></pre>

<pre><code>##  [1] 70 65 63 72 81 83 66 75 80 75 79 76 76 69 75 74 85 86 71 64 78 80 74
## [24] 72 77 81 82 80 80 80 87
</code></pre>

<p>You might have noticed the <code>[24]</code> in the second line of <code>trees[, 2]</code>. This indicates that the 72 next to it is the 24th element of that vector. There just isn&#39;t enough room on the screen to show it all in one line.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>Finer subsetting</h2>
  </hgroup>
  <article>
    <p>We can get individual values by setting both rows and columns</p>

<pre><code class="r">trees[3, 2]
</code></pre>

<pre><code>## [1] 63
</code></pre>

<pre><code class="r">trees[1, 1]
</code></pre>

<pre><code>## [1] 8.3
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>The last elements</h2>
  </hgroup>
  <article>
    <p>And we can also use <code>nrow</code> and <code>ncol</code> (gets the number of rows or columns) to get the last elements:</p>

<pre><code class="r">nrow(trees)
</code></pre>

<pre><code>## [1] 31
</code></pre>

<pre><code class="r">trees[nrow(trees), ]
</code></pre>

<pre><code>##    Girth Height Volume
## 31  20.6     87     77
</code></pre>

<pre><code class="r">trees[, ncol(trees)]
</code></pre>

<pre><code>##  [1] 10.3 10.3 10.2 16.4 18.8 19.7 15.6 18.2 22.6 19.9 24.2 21.0 21.4 21.3
## [15] 19.1 22.2 33.8 27.4 25.7 24.9 34.5 31.7 36.3 38.3 42.6 55.4 55.7 58.3
## [29] 51.5 51.0 77.0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h2>Why stop at one?</h2>
  </hgroup>
  <article>
    <p>You can also subset collections of elements. To get the fourth to seventh row of the first and third column:</p>

<pre><code class="r">trees[4:7, c(1, 3)]
</code></pre>

<pre><code>##   Girth Volume
## 4  10.5   16.4
## 5  10.7   18.8
## 6  10.8   19.7
## 7  11.0   15.6
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="quiz" id="slide-21" style="background:;">
  <hgroup>
    <h2>Subsetting quiz</h2>
  </hgroup>
  <article>
    
<div class="quiz-single well new">
  <h3>What is the number in the third last row of the 2nd column of <code>trees</code>?</h3>

<ol>
<li><em>80</em></li>
<li>87</li>
<li>65</li>
<li>10.3</li>
</ol>


  
  <button class="quiz-submit btn btn-primary">Submit</button>
  
  <button class="quiz-show-answer btn btn-success">Show Answer</button>
  <button class="quiz-clear">Clear</button>
  
  
  <div class="quiz-hint">
    
  </div>
  
  <div class="quiz-explanation">
    <p>Using the line <code>trees[nrow(trees) - 2, 2]</code> will get you the third last row of the second column. Third last is the last one minus 2 places.</p>

  </div>
</div>
  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-22" style="background:;">
  <hgroup>
    <h2>Other ways of extracting columns</h2>
  </hgroup>
  <article>
    <p>Data frames are collections of vectors, so you can use their names to extract them. You can use your original notation and also <code>$</code> notation (which is convenient, but not as powerful).</p>

<pre><code class="r">trees[, &quot;Height&quot;]
</code></pre>

<pre><code>##  [1] 70 65 63 72 81 83 66 75 80 75 79 76 76 69 75 74 85 86 71 64 78 80 74
## [24] 72 77 81 82 80 80 80 87
</code></pre>

<pre><code class="r">trees$Height
</code></pre>

<pre><code>##  [1] 70 65 63 72 81 83 66 75 80 75 79 76 76 69 75 74 85 86 71 64 78 80 74
## [24] 72 77 81 82 80 80 80 87
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>Subsetting by a conditional</h2>
  </hgroup>
  <article>
    <p>Often, we want all the rows that meet a certain condition. Say I want all the trees where the height is greater than 82 ft. First, I can produce a TRUE/FALSE variable, then take only the cases where it is true:</p>

<pre><code class="r">greater82 &lt;- trees$Height &gt; 82
greater82[1:5]
</code></pre>

<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE
</code></pre>

<pre><code class="r">trees[greater82, ]
</code></pre>

<pre><code>##    Girth Height Volume
## 6   10.8     83   19.7
## 17  12.9     85   33.8
## 18  13.3     86   27.4
## 31  20.6     87   77.0
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="quiz" id="slide-24" style="background:;">
  <hgroup>
    <h2>Logical subsetting quiz</h2>
  </hgroup>
  <article>
    
<div class="quiz-single well new">
  <h3>How many trees are there with a girth less than 12.5 inches?</h3>

<ol>
<li>3</li>
<li>8</li>
<li>0</li>
<li><em>15</em></li>
</ol>


  
  <button class="quiz-submit btn btn-primary">Submit</button>
  
  <button class="quiz-show-answer btn btn-success">Show Answer</button>
  <button class="quiz-clear">Clear</button>
  
  
  <div class="quiz-hint">
    
  </div>
  
  <div class="quiz-explanation">
    <p>Using the code <code>trees[trees$Girth &lt; 12.5, ]</code>, we can see that there are 15 trees with a girth less than 12.5. Press &#39;p&#39; to see the whole expected output.</p>


  </div>
</div>
  </article>
  <!-- Presenter Notes -->
  <aside class="note">
    <section>
      <pre><code class="r">trees[trees$Girth &lt; 12.5, ]
</code></pre>

<pre><code>##    Girth Height Volume
## 1    8.3     70   10.3
## 2    8.6     65   10.3
## 3    8.8     63   10.2
## 4   10.5     72   16.4
## 5   10.7     81   18.8
## 6   10.8     83   19.7
## 7   11.0     66   15.6
## 8   11.0     75   18.2
## 9   11.1     80   22.6
## 10  11.2     75   19.9
## 11  11.3     79   24.2
## 12  11.4     76   21.0
## 13  11.4     76   21.4
## 14  11.7     69   21.3
## 15  12.0     75   19.1
</code></pre>

    </section>
  </aside>
</slide>

      <slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2>Plotting data</h2>
  </hgroup>
  <article>
    <p>A plot is worth a thousand words... Well, R is capable of plotting data in many different ways. Let&#39;s start some basic function:</p>

<h3>Histogram</h3>

<pre><code class="r">hist(trees[, 2])
</code></pre>

<p><img src="figure/unnamed-chunk-20.png" alt="plot of chunk unnamed-chunk-20"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>Making nice plots</h2>
  </hgroup>
  <article>
    <p>Let&#39;s use some extra arguments for the funtion <code>hist()</code>:</p>

<pre><code class="r">hist(trees[, 2], xlab = &quot;Height&quot;, main = &quot;Our first plot!&quot;)
</code></pre>

<p><img src="figure/unnamed-chunk-21.png" alt="plot of chunk unnamed-chunk-21"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-27" style="background:;">
  <hgroup>
    <h2>Boxplots</h2>
  </hgroup>
  <article>
    <p>Another simple and useful plot is the boxplot. Remember that we can fix up those messy axis labels with the xlab and ylab arguments. We&#39;ll use another sample dataset (<code>CO2</code>) so remember to check its structure.</p>

<pre><code class="r">boxplot(uptake ~ Plant, data = CO2, xlab = &quot;Plant&quot;, ylab = expression(CO[2] ~ 
    &quot;uptake&quot;))
</code></pre>

<p><img src="figure/unnamed-chunk-22.png" alt="plot of chunk unnamed-chunk-22"> </p>


  </article>
  <!-- Presenter Notes -->
  <aside class="note">
    <section>
      <p>Try other combinations like:</p>

<pre><code class="r">boxplot(uptake ~ Type + Treatment, data = CO2)
</code></pre>

    </section>
  </aside>
</slide>

      <slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>What happen if our data is not organised as we want?</h2>
  </hgroup>
  <article>
    <p>Let&#39;s take a look to the dataset <code>co2</code> and modify it...</p>

<pre><code class="r">dim.names &lt;- list(month.abb, unique(floor(time(co2))))
data.co2 &lt;- as.data.frame(t(matrix(co2, 12, dimnames = dim.names)), row.names = F)
data.co2$year &lt;- as.numeric(dim.names[[2]])
head(data.co2)
</code></pre>

<pre><code>##     Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec
## 1 315.4 316.3 316.5 317.6 318.1 318.0 316.4 314.6 313.7 313.2 314.7 315.4
## 2 316.3 316.8 317.4 318.9 319.9 319.4 318.0 315.7 314.0 313.7 314.8 316.0
## 3 316.7 317.5 318.4 319.3 320.4 319.6 318.4 316.6 314.8 315.2 315.9 316.9
## 4 317.8 318.4 319.5 320.4 320.9 320.4 319.4 317.2 316.1 315.3 316.5 317.5
## 5 318.6 318.9 319.7 321.2 322.1 321.3 319.6 317.6 316.1 315.8 316.9 318.2
## 6 319.4 320.1 320.7 321.4 322.1 321.7 320.3 318.5 316.5 316.7 317.5 318.6
##   year
## 1 1959
## 2 1960
## 3 1961
## 4 1962
## 5 1963
## 6 1964
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-29" style="background:;">
  <hgroup>
    <h2>Loading in packages</h2>
  </hgroup>
  <article>
    <p>For the next modification we will need to load a new library (and posibly install it!).</p>

<pre><code class="r">install.packages(&quot;reshape2&quot;)
library(reshape2)
</code></pre>

<p>R is free and there are many official packages available (check <a href="http://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN list</a>).</p>

<p>Also many people create their own packages to distribute their work. Most of them are hosted in <a href="http://github.com">github</a> or similar websites. In this workshop you will be using a custom package developed in this Department.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-30" style="background:;">
  <hgroup>
    <h2>Reshaping data</h2>
  </hgroup>
  <article>
    <p>Now we have the reshape2 package loaded in, we can use the <code>melt()</code> function to melt out dataframe. See the <code>?melt.data.frame</code> page for details. The <code>id.vars</code> are the variables we don&#39;t want to melt. The <code>.name</code> arguments control the column names of the result:</p>

<pre><code class="r">data.co2_melt &lt;- melt(data.co2, id.vars = &quot;year&quot;, variable.name = &quot;month&quot;, value.name = &quot;co2&quot;)
head(data.co2_melt)
</code></pre>

<pre><code>##   year month   co2
## 1 1959   Jan 315.4
## 2 1960   Jan 316.3
## 3 1961   Jan 316.7
## 4 1962   Jan 317.8
## 5 1963   Jan 318.6
## 6 1964   Jan 319.4
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>More plots</h2>
  </hgroup>
  <article>
    <p>Now that we have stacked data, it&#39;s much easier to make plots. For example, it&#39;s easy to make a simple scatterplot.</p>

<pre><code class="r">plot(co2 ~ year, data = data.co2_melt)
</code></pre>

<p><img src="figure/unnamed-chunk-28.png" alt="plot of chunk unnamed-chunk-28"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-32" style="background:;">
  <hgroup>
    <h2>plyr</h2>
  </hgroup>
  <article>
    <p>Stacking out data has also made our data easier to summarise. We&#39;re going to use the <code>plyr</code> package. In particular, a function <code>ddply()</code> Let&#39;s start with something simple. Let&#39;s get the mean temperature for each Depth:</p>

<pre><code class="r">library(plyr)
year_mean &lt;- ddply(data.co2_melt, c(&quot;year&quot;), summarise, meanco2 = mean(co2))
head(year_mean)
</code></pre>

<pre><code>##   year meanco2
## 1 1959   315.8
## 2 1960   316.7
## 3 1961   317.5
## 4 1962   318.3
## 5 1963   318.8
## 6 1964   319.5
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-33" style="background:;">
  <hgroup>
    <h2>Plotting summaries</h2>
  </hgroup>
  <article>
    <p>Now we can plot that easily:</p>

<pre><code class="r">plot(meanco2 ~ year, data = year_mean)
</code></pre>

<p><img src="figure/unnamed-chunk-30.png" alt="plot of chunk unnamed-chunk-30"> </p>


  </article>
  <!-- Presenter Notes -->
  <aside class="note">
    <section>
      <p>Try how a monthly mean looks like!</p>

<pre><code>## Error: object &#39;month_mean&#39; not found
</code></pre>

    </section>
  </aside>
</slide>

      <slide class="" id="slide-34" style="background:;">
  <hgroup>
    <h2>ggplot2</h2>
  </hgroup>
  <article>
    <p><code>ggplot2</code> is a powerful package which allows you to build up complex plots from basic elements.</p>

<pre><code class="r">ggplot(data.co2_melt, aes(x = year, y = co2)) + geom_point()
</code></pre>

<pre><code>## Error: could not find function &quot;ggplot&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>Adding some colour</h2>
  </hgroup>
  <article>
    <p>With a few modifications to the original code we can generate a much clear plot.</p>

<pre><code class="r">ggplot(data.co2_melt, aes(x = year, y = co2, colour = month)) + geom_line()
</code></pre>

<pre><code>## Error: could not find function &quot;ggplot&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-36" style="background:;">
  <hgroup>
    <h2>More complex plots?</h2>
  </hgroup>
  <article>
    <p>We can go back to our melted data and look at all the concentrations of carbon dioxide over time, for each month using facets.</p>

<pre><code class="r">ggplot(data.co2_melt, aes(x = year, y = co2)) + geom_line() + facet_wrap(~month)
</code></pre>

<pre><code>## Error: could not find function &quot;ggplot&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-37" style="background:;">
  <hgroup>
    <h2>Linear models</h2>
  </hgroup>
  <article>
    <p>If we want to check the behaviour of the carbon dioxid concentration over time, we can use the function &#39;lm()&#39;</p>

<pre><code class="r">model_ &lt;- lm(co2 ~ year, data = data.co2_melt)
model_
</code></pre>

<pre><code>## 
## Call:
## lm(formula = co2 ~ year, data = data.co2_melt)
## 
## Coefficients:
## (Intercept)         year  
##    -2255.11         1.31
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-38" style="background:;">
  <hgroup>
    <h2>Getting things out of a linear model</h2>
  </hgroup>
  <article>
    <p>We can access some important information using <code>summary()</code></p>

<pre><code class="r">summary(model_)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = co2 ~ year, data = data.co2_melt)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.653 -1.807  0.053  1.695  6.405 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -2.26e+03   1.99e+01    -113   &lt;2e-16 ***
## year         1.31e+00   1.01e-02     130   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Residual standard error: 2.45 on 466 degrees of freedom
## Multiple R-squared: 0.973,   Adjusted R-squared: 0.973 
## F-statistic: 1.7e+04 on 1 and 466 DF,  p-value: &lt;2e-16
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-39" style="background:;">
  <hgroup>
    <h2>SS tables</h2>
  </hgroup>
  <article>
    <p>We can produce familiar tables containing sum of squares and pvalues using the <code>anova()</code> function:</p>

<pre><code class="r">anova(model_)
</code></pre>

<pre><code>## Analysis of Variance Table
## 
## Response: co2
##            Df Sum Sq Mean Sq F value Pr(&gt;F)    
## year        1 101808  101808   16978 &lt;2e-16 ***
## Residuals 466   2794       6                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-40" style="background:;">
  <hgroup>
    <h2>Linear models: Plot</h2>
  </hgroup>
  <article>
    <p>Let&#39;s plot the previous data and fitted linear model:</p>

<pre><code class="r">plot(co2 ~ year, data = data.co2_melt)
abline(model_, col = &quot;blue&quot;, lwd = 2)
</code></pre>

<p><img src="figure/unnamed-chunk-38.png" alt="plot of chunk unnamed-chunk-38"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-41" style="background:;">
  <hgroup>
    <h2>Linear models: Predicting</h2>
  </hgroup>
  <article>
    <p>What a horrible trend we have there... let&#39;s see what would happend until the year 2020 if we don&#39;t do something to change that...</p>

<pre><code class="r">predictions &lt;- predict(model_, newdata = data.frame(year = 1997:2020))
plot(co2 ~ year, data = data.co2_melt, xlim = c(min(data.co2_melt$year), 2020), 
    ylim = c(min(data.co2_melt$co2), max(predictions)))
points(1997:2020, predictions, col = &quot;red&quot;)
</code></pre>

<p><img src="figure/unnamed-chunk-39.png" alt="plot of chunk unnamed-chunk-39"> </p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-42" style="background:;">
  <hgroup>
    <h2>So, I am in spectroscopy workshop... but...</h2>
  </hgroup>
  <article>
    <p>Ok, ok... We&#39;ll use some spectroscopy data to show you two last tasks you can do with R: loading data files and making your own functions.</p>

<h3>Preparing R session</h3>

<p>Let&#39;s prepare our session to work with our files:</p>

<pre><code class="r">getwd()
</code></pre>

<p>Now set the working directory with the correct path using the function <code>setwd()</code>. If you are not sure how to do it, you can use the help for that command typing <code>?setwd</code>.</p>

<pre><code class="r">setwd(&quot;path to directory&quot;)
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-43" style="background:;">
  <hgroup>
    <h2>Loading data files</h2>
  </hgroup>
  <article>
    <p>Let&#39;s take a look to the next <a href="https://raw.github.com/sebastian-c/r-apr2013/gh-pages/spec.zip">spectroscopy data</a> (save it in your computer).</p>

<p>If we try directly with the function <code>read.table()</code></p>

<pre><code class="r">spec_data &lt;- read.table(file = &quot;kaolinite_cm9.11962.asc&quot;)
</code></pre>

<pre><code>## Error: line 1 did not have 8 elements
</code></pre>

<p>!!!!</p>

<p>Relax... Let&#39;s open the file in an external text editor...</p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-44" style="background:;">
  <hgroup>
    <h2>Loading data files</h2>
  </hgroup>
  <article>
    <p>After checking the structure of the file we can use extra arguments for the funtion <code>read.table()</code></p>

<pre><code class="r">spec_data &lt;- read.table(file = &quot;kaolinite_cm9.11962.asc&quot;, skip = 16, na.strings = &quot;-1.23e34&quot;, 
    col.names = c(&quot;wavelength&quot;, &quot;reflectance&quot;, &quot;sd&quot;))
spec_data$wavelength &lt;- spec_data$wavelength * 1000
head(spec_data)
</code></pre>

<pre><code>##   wavelength reflectance       sd
## 1      205.1          NA 0.000000
## 2      213.1          NA 0.093990
## 3      221.1          NA 0.026866
## 4      229.1          NA 0.011748
## 5      236.1          NA 0.008168
## 6      242.1          NA 0.005388
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-45" style="background:;">
  <hgroup>
    <h2>Do I have to do this every time?</h2>
  </hgroup>
  <article>
    <p>Usually we have to do tedious and repetitive tasks (like the one we just did). In those cases is recomended to create a function to automatise this process.</p>

<pre><code class="r">read_spec &lt;- function(.spectra_file) {
    .data &lt;- read.table(file = .spectra_file, skip = 16, na.strings = &quot;-1.23e34&quot;, 
        col.names = c(&quot;wavelength&quot;, &quot;reflectance&quot;, &quot;sd&quot;))
    .data[, 1] &lt;- .data[, 1] * 1000
    .data
}

kaol &lt;- read_spec(.spectra_file = &quot;kaolinite_cm9.11962.asc&quot;)
head(kaol)
</code></pre>

<pre><code>##   wavelength reflectance       sd
## 1      205.1          NA 0.000000
## 2      213.1          NA 0.093990
## 3      221.1          NA 0.026866
## 4      229.1          NA 0.011748
## 5      236.1          NA 0.008168
## 6      242.1          NA 0.005388
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-46" style="background:;">
  <hgroup>
    <h2>What about another file?</h2>
  </hgroup>
  <article>
    <p>If the other files have the same struture, you can keep using that funcion to read data in.</p>

<pre><code class="r">mont &lt;- read_spec(.spectra_file = &quot;montmorillonite_sca2.14557.asc&quot;)
head(mont, 3)
</code></pre>

<pre><code>##   wavelength reflectance       sd
## 1      205.1          NA 0.045997
## 2      213.1          NA 0.006912
## 3      221.1     0.03019 0.002152
</code></pre>

<pre><code class="r">illi &lt;- read_spec(.spectra_file = &quot;illite_imt1.10982.asc&quot;)
head(illi, 3)
</code></pre>

<pre><code>##   wavelength reflectance      sd
## 1      205.1          NA 0.00000
## 2      213.1          NA 0.11321
## 3      221.1          NA 0.04883
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-47" style="background:;">
  <hgroup>
    <h2>Fun to look forward to:</h2>
  </hgroup>
  <article>
    <p>When you have a bit more R experience, you can make graphs like the following:</p>

<ul>
<li>Dates</li>
<li>RGoogleVis (done)</li>
<li>This presentation</li>
<li>Soil graphs (from different data)</li>
<li>Map with points in R</li>
<li>More!</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-48" style="background:;">
  <hgroup>
    <h2>Soil profiles</h2>
  </hgroup>
  <article>
    <p>Plot soil profiles with the help of package <code>aqp</code>:</p>

<p><img src="images/profiles.png" style="margin:0px auto;display:block"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-49" style="background:;">
  <hgroup>
    <h2>Georeferenced data</h2>
  </hgroup>
  <article>
    <p>Plot soil profiles locations:</p>

<p><img src="images/map.png" style="margin:0px auto;display:block"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-50" style="background:;">
  <hgroup>
    <h2>Images processing</h2>
  </hgroup>
  <article>
    <p><img src="images/processing.png" style="margin:0px auto;display:block"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-51" style="background:;">
  <hgroup>
    <h2>This presentation!</h2>
  </hgroup>
  <article>
    <p>This presentation was entirely made in R using some useful packages such as <a href="http://slidify.org">slidify</a> (<a href="http://ramnathv.github.com/slidify/">Vaidyanathan, 2012</a>). You can look at the source for it on <a href="https://github.com/sebastian-c/r-mar2013">GitHub</a>.</p>

<p><img src="images/thispresentation.png" alt=""></p>

  </article>
  <!-- Presenter Notes -->
</slide>

      <slide class="" id="slide-52" style="background:;">
  <hgroup>
    <h2>Bibliography</h2>
  </hgroup>
  <article>
    <p><p>Vaidyanathan R (2012).
<EM>slidify: Generate reproducible html5 slides from R markdown</EM>.
R package version 0.3.3, <a href="http://ramnathv.github.com/slidify/"><a href="http://ramnathv.github.com/slidify/">http://ramnathv.github.com/slidify/</a></a>.</p>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>

  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
<!-- Grab CDN jQuery, fall back to local if offline -->
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
<script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery-1.7.min.js"><\/script>')</script>
<!-- Load Javascripts for Widgets -->
<!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script> -->
<script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<script src='libraries/widgets/quiz/js/jquery.quiz.js'></script>
<script src='libraries/widgets/quiz/js/mustache.min.js'></script>
<script type="text/javascript">
 $('.quiz').find('li:has(em)').addClass('quiz-answer')
 $('li.quiz-answer em').replaceWith(function(){
   return $(this).contents()
 })
 $('.quiz').find('li').addClass('quiz-option')
 $.quiz();
</script>
<script src='libraries/widgets/bootstrap/js/bootstrap.min.js'></script>
<script>  
$(function (){ 
  $("#example").popover(); 
  $("[rel='tooltip']").tooltip(); 
});  
</script>  
<!-- LOAD HIGHLIGHTER JS FILES -->
<script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- DONE LOADING HIGHLIGHTER JS FILES -->
</html>